<!doctype html>





  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Cpp," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="Overview我们这里介绍怎样从图像中抽取一些有用的特征来进行图像的分析。

In order to perform content-based analysis of an image, it is necessary toextract meaningful features from the collection of pixels that constitutethe image.

C">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenCV系列笔记二十三：Extracting Lines, Contours, and Components">
<meta property="og:url" content="http://datahonor.com/2017/05/27/Extracting-Lines-Contours-and-Components/index.html">
<meta property="og:site_name" content="DATA HONOR">
<meta property="og:description" content="Overview我们这里介绍怎样从图像中抽取一些有用的特征来进行图像的分析。

In order to perform content-based analysis of an image, it is necessary toextract meaningful features from the collection of pixels that constitutethe image.

C">
<meta property="og:image" content="http://blog-1252464519.costj.myqcloud.com/1705/Selection_052701.png">
<meta property="og:image" content="http://blog-1252464519.costj.myqcloud.com/1705/Selection_052804.png">
<meta property="og:image" content="http://datahonor-1252464519.costj.myqcloud.com/201705/Detected%20Circles_052901.png">
<meta property="og:image" content="http://datahonor-1252464519.costj.myqcloud.com/201705/Selection_052902.png">
<meta property="og:image" content="http://datahonor-1252464519.costj.myqcloud.com/201705/Selection_052903.png">
<meta property="og:image" content="http://datahonor-1252464519.costj.myqcloud.com/201705/Selection_052904.png">
<meta property="og:updated_time" content="2017-05-29T08:10:30.146Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="OpenCV系列笔记二十三：Extracting Lines, Contours, and Components">
<meta name="twitter:description" content="Overview我们这里介绍怎样从图像中抽取一些有用的特征来进行图像的分析。

In order to perform content-based analysis of an image, it is necessary toextract meaningful features from the collection of pixels that constitutethe image.

C">
<meta name="twitter:image" content="http://blog-1252464519.costj.myqcloud.com/1705/Selection_052701.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"right","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":true},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '不秩稚童'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://datahonor.com/2017/05/27/Extracting-Lines-Contours-and-Components/"/>





  <title> OpenCV系列笔记二十三：Extracting Lines, Contours, and Components | DATA HONOR </title><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  




<!-- hexo-inject:begin --><!-- hexo-inject:end --><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-92663335-1', 'auto');
  ga('send', 'pageview');
</script>


  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?cbfd16620150a28ce4061f717038b4de";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">DATA HONOR</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Never say never.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://datahonor.com/2017/05/27/Extracting-Lines-Contours-and-Components/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="不秩稚童">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="https://avatars2.githubusercontent.com/u/17157965?v=3&u=1787d5d04d50967c7825062bfff705ee584ae2b2&s=400">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="DATA HONOR">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="DATA HONOR" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                OpenCV系列笔记二十三：Extracting Lines, Contours, and Components
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-05-27T09:01:01+08:00">
                2017-05-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cpp/" itemprop="url" rel="index">
                    <span itemprop="name">Cpp</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/05/27/Extracting-Lines-Contours-and-Components/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/05/27/Extracting-Lines-Contours-and-Components/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>本文总阅读量
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h4><p>我们这里介绍怎样从图像中抽取一些有用的特征来进行图像的分析。</p>
<blockquote>
<p>In order to perform content-based analysis of an image, it is necessary to<br>extract meaningful features from the collection of pixels that constitute<br>the image.</p>
</blockquote>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><h5 id="Find-contours-by-Canny-operator"><a href="#Find-contours-by-Canny-operator" class="headerlink" title="Find contours by Canny operator"></a>Find contours by Canny operator</h5><p>之前，我们也简单介绍了基于梯度的图像的边缘检测，但是有两个缺点：第一是边缘有些厚，第二用于分割的阀值很难找到。所以我们这里介绍Canny算子。</p>
<p>原理部分，参考<a href="http://docs.opencv.org/2.4/doc/tutorials/imgproc/imgtrans/canny_detector/canny_detector.html" target="_blank" rel="external">文档</a>,写的很精彩。主要就是Non-maximum suppression和Hysteresis threshold的理解。</p>
<p>一个简单的demo:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cv.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/imgcodecs.hpp&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv/cv.hpp&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</div><div class="line">    cv::Mat image = cv::imread(<span class="string">"/home/shensir/Documents/MyPrograming/Cpp/Clions/data/road.jpg"</span>, <span class="number">0</span>);</div><div class="line">    cv::namedWindow(<span class="string">"Original Image"</span>);</div><div class="line">    cv::imshow(<span class="string">"Original Image"</span>, image);</div><div class="line"></div><div class="line">    <span class="comment">// Apply Canny algorithm</span></div><div class="line">    cv::Mat contours;</div><div class="line">    cv::Canny(image, contours, <span class="number">125</span>, <span class="number">350</span>);  <span class="comment">// contours &#123;0,255&#125;,边缘为255</span></div><div class="line">    cv::namedWindow(<span class="string">"Canny Image"</span>);</div><div class="line">    <span class="comment">// 为了便于观察，取反色</span></div><div class="line">    cv::imshow(<span class="string">"Canny Image"</span>, <span class="number">255</span>-contours);</div><div class="line"></div><div class="line">    cv::waitKey();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>输出：</p>
<p><img src="http://blog-1252464519.costj.myqcloud.com/1705/Selection_052701.png" alt=""></p>
<p>除此之外，我们也可以通过pyrUp去除一些细节再进行边缘检测，效果会更好些。参考<a href="http://datahonor.com/2017/02/23/OpenCV-Pyramid-and-Canny/">这里</a></p>
<h5 id="Detecting-lines-in-images-with-the-Hough-transform"><a href="#Detecting-lines-in-images-with-the-Hough-transform" class="headerlink" title="Detecting lines in images with the Hough transform"></a>Detecting lines in images with the Hough transform</h5><p>关于霍夫变换的简单的demo，可以看下<a href="http://datahonor.com/2017/05/28/Hough%E5%8F%98%E6%8D%A2/">这里</a>. 这里，我们使用其进行检测图像中的直线。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#include &lt;cv.h&gt;</div><div class="line">#include &lt;opencv2/imgcodecs.hpp&gt;</div><div class="line">#include &lt;opencv/cv.hpp&gt;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">#define PI 3.1415926</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line"></div><div class="line">int main() &#123;</div><div class="line">    cv::Mat image = cv::imread("/home/shensir/Documents/MyPrograming/Cpp/Clions/data/road.jpg", 0);</div><div class="line">    cv::imshow("Original Image", image);</div><div class="line"></div><div class="line">    // Apply Canny algotithm</div><div class="line">    cv::Mat contours;</div><div class="line">    cv::Canny(image, contours, 125, 350);</div><div class="line">    cv::imshow("Contours", contours);</div><div class="line"></div><div class="line">    // Hough transfrom for line detection</div><div class="line">    std::vector&lt;cv::Vec2f&gt;lines;</div><div class="line">    cv::HoughLines(contours, lines, 1, PI/180, 60);</div><div class="line"></div><div class="line">    std::vector&lt;cv::Vec2f&gt;::const_iterator it = lines.begin();</div><div class="line">    while(it != lines.end())&#123;</div><div class="line"></div><div class="line">        float rho = (*it)[0];  // first element is distance rho</div><div class="line">        float theta = (*it)[1];  // second element is angle theta</div><div class="line"></div><div class="line">        if(theta &lt; PI/4. || theta &gt; 3.*PI/4)&#123;</div><div class="line">            // vertical line</div><div class="line">            // point of intersection of the line with first row</div><div class="line">            cv::Point pt1(rho/cos(theta), 0);</div><div class="line"></div><div class="line">            // point of intersection of the line with last row</div><div class="line">            cv::Point pt2((rho-image.rows*sin(theta))/cos(theta), image.rows);</div><div class="line"></div><div class="line">            // draw white line</div><div class="line">            cv::line(image, pt1, pt2, cv::Scalar(255), 1);</div><div class="line">        &#125;else&#123;</div><div class="line">            // horizontal line</div><div class="line">            // point of intersection of the line with first column</div><div class="line">            cv::Point pt1(0, rho/sin(theta));</div><div class="line">            // point of intersection of the line with last column</div><div class="line">            cv::Point pt2(image.cols, (rho-image.cols*cos(theta))/sin(theta));</div><div class="line">            // draw white line</div><div class="line">            cv::line(image, pt1, pt2, cv::Scalar(255), 1);</div><div class="line">        &#125;</div><div class="line">        ++it;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    cv::imshow("Image", image);</div><div class="line">    cv::waitKey();</div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure>
<p>输出：</p>
<p><img src="http://blog-1252464519.costj.myqcloud.com/1705/Selection_052804.png" alt=""></p>
<p>同样地，只要可以将图像中的形状转化到参数空间，我们都可以用hough变换进行检测，比如圆形的检测：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cv.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv2/imgcodecs.hpp&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;opencv/cv.hpp&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> PI 3.1415926</span></div><div class="line"></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    cv::Mat image = cv::imread(<span class="string">"/home/shensir/Documents/MyPrograming/Cpp/Clions/data/chariot.jpg"</span>, <span class="number">0</span>);</div><div class="line">    <span class="comment">// Detecting circles</span></div><div class="line">    cv::GaussianBlur(image, image, cv::Size(<span class="number">5</span>, <span class="number">5</span>), <span class="number">1.5</span>);</div><div class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Vec3f&gt;circles;</div><div class="line">    cv::HoughCircles(image, circles, cv::HOUGH_GRADIENT,</div><div class="line">                    <span class="number">2</span>, <span class="comment">// accumulator resolution(size of the image/2)</span></div><div class="line">                    <span class="number">20</span>, <span class="comment">// minimum distance between two circles</span></div><div class="line">                    <span class="number">200</span>, <span class="comment">// Canny high threshold</span></div><div class="line">                    <span class="number">60</span>, <span class="comment">// minimum number of vates</span></div><div class="line">                    <span class="number">15</span>,</div><div class="line">                    <span class="number">50</span>);  <span class="comment">// min and max radius</span></div><div class="line"></div><div class="line"></div><div class="line">    <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;cv::Vec3f&gt;::const_iterator itc = circles.begin();</div><div class="line">    <span class="keyword">while</span>(itc!=circles.end())&#123;</div><div class="line">        cv::circle(image, cv::Point((*itc)[<span class="number">0</span>], (*itc)[<span class="number">1</span>]), (*itc)[<span class="number">2</span>], cv::Scalar(<span class="number">255</span>), <span class="number">2</span>);</div><div class="line">        ++itc;</div><div class="line">    &#125;</div><div class="line">    cv::namedWindow(<span class="string">"Detected Circles"</span>);</div><div class="line">    cv::imshow(<span class="string">"Detected Circles"</span>, image);</div><div class="line"></div><div class="line">    cv::waitKey();</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>输出:<br><img src="http://datahonor-1252464519.costj.myqcloud.com/201705/Detected%20Circles_052901.png" alt=""></p>
<p>基于上面的应用，我们来学习下关于Probabilistic Hough transform的应用：</p>
<blockquote>
<p>As can be seen, the Hough transform simply looks for an alignment of edge pixels across the image. This can potentially create some false detections due to incidental pixel alignments or multiple detections when several lines with slightly different parameter values pass through the same alignment of pixels.<br>To overcome some of these problems, and to allow line segments to be detected (that is, with endpoints), a variant of the transform has been proposed. This is the Probabilistic Hough transform, and it is implemented in OpenCV as the cv::HoughLinesP function. </p>
</blockquote>
<p><strong>linefinder.h</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">//</div><div class="line">// Created by shensir on 17-4-21.</div><div class="line">//</div><div class="line"></div><div class="line">#include &lt;opencv2/core.hpp&gt;</div><div class="line">#include &lt;opencv2/imgproc.hpp&gt;</div><div class="line">#define PI 3.1415926</div><div class="line"></div><div class="line">#ifndef CLIONS_LINEFINDER_H</div><div class="line">#define CLIONS_LINEFINDER_H</div><div class="line"></div><div class="line">#endif //CLIONS_LINEFINDER_H</div><div class="line"></div><div class="line">class LineFinder&#123;</div><div class="line">private:</div><div class="line">    // orginal image</div><div class="line">    cv::Mat img;</div><div class="line"></div><div class="line">    // vector containing the endpoints of the detected lines</div><div class="line">    std::vector&lt;cv::Vec4i&gt;lines;</div><div class="line"></div><div class="line">    // accumulator resolution parameters</div><div class="line">    double deltaRHo;</div><div class="line">    double deltaTheta;</div><div class="line"></div><div class="line">    // minimum number of votes that a line</div><div class="line">    // must receive before being considered</div><div class="line">    int minVote;</div><div class="line"></div><div class="line">    // min length for a line</div><div class="line">    double minLength;</div><div class="line"></div><div class="line">    // max allowed gap along the line</div><div class="line">    double maxGap;</div><div class="line"></div><div class="line">public:</div><div class="line">    // Default accumulator resolution is 1 pixel by 1 degree</div><div class="line">    // no gap, no minimum length</div><div class="line">    LineFinder():deltaRHo(1), deltaTheta(PI/180),</div><div class="line">                 minVote(10), minLength(0.), maxGap(0.)&#123;&#125;</div><div class="line"></div><div class="line"></div><div class="line">    // Set the resolution of the accumulator</div><div class="line">    void setAccResolution(double dRho, double dTheta)&#123;</div><div class="line">        deltaRHo = dRho;</div><div class="line">        deltaTheta = dTheta;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Set the minimum member of votes</div><div class="line">    void setMinVote(int minv)&#123;</div><div class="line">        minVote = minv;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Set line length and gap</div><div class="line">    void setLineLengthAndGap(double length, double gap)&#123;</div><div class="line">        minLength = length;</div><div class="line">        maxGap = gap;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Apply probabilistic Hough Transform</div><div class="line">    std::vector&lt;cv::Vec4i&gt;findLines(cv::Mat&amp;binary)&#123;</div><div class="line">        lines.clear();</div><div class="line">        cv::HoughLinesP(binary, lines, deltaRHo, deltaTheta, minVote,</div><div class="line">                        minLength, maxGap);</div><div class="line">        return lines;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    // Draw the detected lines on an image</div><div class="line">    void drawDetectedLines(cv::Mat &amp;image, cv::Scalar color=cv::Scalar(255,255,255))&#123;</div><div class="line"></div><div class="line">        // Draw lines</div><div class="line">        std::vector&lt;cv::Vec4i&gt;::const_iterator it2 = lines.begin();</div><div class="line"></div><div class="line">        while(it2!=lines.end())&#123;</div><div class="line">            cv::Point pt1((*it2)[0], (*it2)[1]);</div><div class="line">            cv::Point pt2((*it2)[2], (*it2)[3]);</div><div class="line"></div><div class="line">            cv::line(image, pt1, pt2, color);</div><div class="line">            ++it2;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p><strong>main.cpp</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#include &lt;cv.h&gt;</div><div class="line">#include &lt;opencv2/imgcodecs.hpp&gt;</div><div class="line">#include &lt;opencv/cv.hpp&gt;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">#include &quot;linefinder.h&quot;</div><div class="line">#define PI 3.1415926</div><div class="line"></div><div class="line">using namespace std</div><div class="line"></div><div class="line"></div><div class="line">int main() &#123;</div><div class="line">    cv::Mat image = cv::imread(&quot;/home/shensir/Documents/MyPrograming/Cpp/Clions/data/road.jpg&quot;, 0);</div><div class="line">    cv::imshow(&quot;Original Image&quot;, image);</div><div class="line"></div><div class="line">    // Apply Canny algotithm</div><div class="line">    cv::Mat contours;</div><div class="line">    cv::Canny(image, contours, 125, 350);</div><div class="line">    cv::imshow(&quot;Contours&quot;, contours);</div><div class="line"></div><div class="line">        // Create LineFinder instance</div><div class="line">    LineFinder finder;</div><div class="line"></div><div class="line">    // Set probabilistic Hough parameters</div><div class="line">    finder.setLineLengthAndGap(100, 20);</div><div class="line">    finder.setMinVote(60);</div><div class="line"></div><div class="line">    // Detect lines and draw them in the image</div><div class="line">    std::vector&lt;cv::Vec4i&gt;lines = finder.findLines(contours);</div><div class="line">    finder.drawDetectedLines(image);</div><div class="line"></div><div class="line">    cv::namedWindow(&quot;Lines with HoughP&quot;);</div><div class="line">    cv::imshow(&quot;Lines with HoughP&quot;, image);</div><div class="line"></div><div class="line">    cv::waitKey();</div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>输出：<br><img src="http://datahonor-1252464519.costj.myqcloud.com/201705/Selection_052902.png" alt=""></p>
<h5 id="Extracting-connected-components-amp-amp-Computing-components’-shape-descriptors"><a href="#Extracting-connected-components-amp-amp-Computing-components’-shape-descriptors" class="headerlink" title="Extracting connected components &amp;&amp; Computing components’ shape descriptors"></a>Extracting connected components &amp;&amp; Computing components’ shape descriptors</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#include &lt;cv.h&gt;</div><div class="line">#include &lt;opencv2/imgcodecs.hpp&gt;</div><div class="line">#include &lt;opencv/cv.hpp&gt;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">#define PI 3.1415926</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">// Eliminate too short or too long contours</div><div class="line">void BalanceLength(std::vector&lt;std::vector&lt;cv::Point&gt;&gt;&amp; contours)&#123;</div><div class="line">    int cmin = 80;  // minimum contour length</div><div class="line">    int cmax = 500;  // maximum contours length</div><div class="line">    std::vector&lt;std::vector&lt;cv::Point&gt;&gt;::iterator itc = contours.begin();</div><div class="line"></div><div class="line">    // for all contours</div><div class="line">    while( itc != contours.end())&#123;</div><div class="line">        // verify contour size</div><div class="line">        if(itc-&gt;size() &lt; cmin || itc-&gt;size() &gt; cmax)</div><div class="line">            itc = contours.erase(itc);</div><div class="line">        else</div><div class="line">            ++itc;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">int main()&#123;</div><div class="line"></div><div class="line">    cv::Mat image = cv::imread("/home/shensir/Documents/MyPrograming/Cpp/Clions/data/marphimg.png", 0);</div><div class="line">    cv::imshow("Original Image", image);</div><div class="line">    // the vector that will contain the contours</div><div class="line">    std::vector&lt;std::vector&lt;cv::Point&gt;&gt; contours;</div><div class="line">    cv::findContours(image,</div><div class="line">                    contours,   // a vector og contours</div><div class="line">                    cv::RETR_EXTERNAL,  //retieve the external contours</div><div class="line">                    cv::CHAIN_APPROX_NONE);  // all pixels of each contours</div><div class="line"></div><div class="line"></div><div class="line">    // draw black contours on a white image</div><div class="line">    cv::Mat result(image.size(), CV_8U, cv::Scalar(255));</div><div class="line">    cv::drawContours(result, contours, -1, 0, 2); // draw all contours; in black; with a thickness of 2</div><div class="line">    cv::imshow("result_before_elimination", result);</div><div class="line"></div><div class="line">    // Eliminate too short or too long contours</div><div class="line">    BalanceLength(contours);</div><div class="line"></div><div class="line">    cv::Mat result1(image.size(), CV_8U, cv::Scalar(255));</div><div class="line">    cv::drawContours(result1, contours, -1, 0, 2); // draw all contours; in black; with a thickness of 2</div><div class="line">    cv::imshow("result_after_elimination", result1);</div><div class="line"></div><div class="line">    // testing the bounding box</div><div class="line">    cv::Rect r0 = cv::boundingRect(contours[0]);</div><div class="line">    // draw the rectangle</div><div class="line">    cv::rectangle(result1, r0, 0, 2);</div><div class="line">    cv::imshow("boundingbox", result1);</div><div class="line"></div><div class="line">    // testing the enclosing circle</div><div class="line">    float radius;</div><div class="line">    cv::Point2f center;</div><div class="line">    cv::minEnclosingCircle(contours[1],center,radius);</div><div class="line">    // draw the cricle</div><div class="line">    cv::circle(result1,center,static_cast&lt;int&gt;(radius), cv::Scalar(0), 2);</div><div class="line">    cv::imshow("enclosing", result1);</div><div class="line"></div><div class="line">    // testing the approximate polygon</div><div class="line">    std::vector&lt;cv::Point&gt; poly;</div><div class="line">    cv::approxPolyDP(contours[2], poly, 5, true);</div><div class="line">    // draw the polygon</div><div class="line">    cv::polylines(result1, poly, true, 0, 2);</div><div class="line">    cv::imshow("Poly", result1);</div><div class="line"></div><div class="line"></div><div class="line">    // testing the convex hull</div><div class="line">    std::vector&lt;cv::Point&gt;hull;</div><div class="line">    cv::convexHull(contours[3], hull);</div><div class="line">    // draw the polygon</div><div class="line">    cv::polylines(result1, hull, true, 0, 2);</div><div class="line">    cv::imshow("convexhull", result1);</div><div class="line"></div><div class="line">    // testing the moments</div><div class="line">    // iterator over all contours</div><div class="line">    std::vector&lt;std::vector&lt;cv::Point&gt;&gt;::iterator itc = contours.begin();</div><div class="line">    while(itc!=contours.end())&#123;</div><div class="line">        // compute all moments</div><div class="line">        cv::Moments mom = cv::moments(cv::Mat(*itc++));</div><div class="line"></div><div class="line">        // draw mess center</div><div class="line">        cv::circle(result1, cv::Point(mom.m10/mom.m00, mom.m01/mom.m00),</div><div class="line">        2, cv::Scalar(0), 2);  // draw black dot</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    cv::imshow("Moments", result1);</div><div class="line"></div><div class="line"></div><div class="line">    // original color image of cattles</div><div class="line">    cv::Mat colorImage  = cv::imread("/home/shensir/Documents/MyPrograming/Cpp/Clions/data/cattle.png");</div><div class="line">    cv::imshow("OriginalColorImage", colorImage);</div><div class="line"></div><div class="line">    cv::drawContours(colorImage, contours, -1, cv::Scalar(255,255,255), 2); // draw all contours; in black; with a thickness of 2</div><div class="line">    cv::imshow("colorImage", colorImage);</div><div class="line"></div><div class="line">    cv::waitKey(0);</div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>输出：</p>
<p><img src="http://datahonor-1252464519.costj.myqcloud.com/201705/Selection_052903.png" alt=""></p>
<h5 id="Quadrilateral-detection"><a href="#Quadrilateral-detection" class="headerlink" title="Quadrilateral detection"></a>Quadrilateral detection</h5><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">#include &lt;cv.h&gt;</div><div class="line">#include &lt;opencv2/imgcodecs.hpp&gt;</div><div class="line">#include &lt;opencv/cv.hpp&gt;</div><div class="line">#include &lt;iostream&gt;</div><div class="line">#define PI 3.1415926</div><div class="line"></div><div class="line">using namespace std;</div><div class="line"></div><div class="line">int main()&#123;</div><div class="line">    cv::Mat components = cv::imread("/home/shensir/Documents/MyPrograming/Cpp/Clions/data/mser.bmp", 0);</div><div class="line">    cv::imshow("Raw Image", components);</div><div class="line"></div><div class="line">    // binary</div><div class="line">    components = components == 255;</div><div class="line">    cv::imshow("Binary", components);</div><div class="line"></div><div class="line">    // open the image (white background)</div><div class="line">    // clean the image with a morphological filter</div><div class="line">    cv::morphologyEx(components,components,</div><div class="line">                    cv::MORPH_OPEN, cv::Mat(),</div><div class="line">                    cv::Point(-1,-1), 3);</div><div class="line"></div><div class="line">    cv::imshow("After bin-morph", components);</div><div class="line"></div><div class="line">    // invert image (background must be black)</div><div class="line">    cv::Mat componentsInv = 255 - components;</div><div class="line"></div><div class="line">    // Get the contours of the connected components</div><div class="line">    std::vector&lt;std::vector&lt;cv::Point&gt;&gt; contours;</div><div class="line">    cv::findContours(componentsInv, contours, cv::RETR_EXTERNAL,</div><div class="line">                    cv::CHAIN_APPROX_NONE);</div><div class="line"></div><div class="line">    // white image</div><div class="line">    cv::Mat quadri(components.size(), CV_8U, 255);</div><div class="line"></div><div class="line">    // for all contours</div><div class="line">    std::vector&lt;std::vector&lt;cv::Point&gt;&gt;::iterator it = contours.begin();</div><div class="line">    std::vector&lt;cv::Point&gt; poly;</div><div class="line">    while (it != contours.end())&#123;</div><div class="line">        poly.clear();</div><div class="line">        cv::approxPolyDP(*it, poly, 5, true);</div><div class="line"></div><div class="line">        // do we have a quadrilateral?</div><div class="line">        if(poly.size() == 4)  //draw it</div><div class="line">            cv::polylines(quadri, poly, true, 0, 2);</div><div class="line">        ++it;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    cv::imshow("Quadri", quadri);</div><div class="line">    cv::waitKey();</div><div class="line">    return 0;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<p>输出：</p>
<p><img src="http://datahonor-1252464519.costj.myqcloud.com/201705/Selection_052904.png" alt=""></p>

      
    </div>

    <div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script>
  <script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css">
  <p><span>本文标题:</span><a href="/2017/05/27/Extracting-Lines-Contours-and-Components/">OpenCV系列笔记二十三：Extracting Lines, Contours, and Components</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 不秩稚童 的个人博客">不秩稚童</a></p>
  <p><span>作者邮箱:</span>datahonor@gmail.com</p>
  <p><span>发布时间:</span>2017年05月27日 - 09:05</p>
  <p><span>最后更新:</span>2017年05月29日 - 16:05</p>
  <p><span>原始链接:</span><a href="/2017/05/27/Extracting-Lines-Contours-and-Components/" title="OpenCV系列笔记二十三：Extracting Lines, Contours, and Components">http://datahonor.com/2017/05/27/Extracting-Lines-Contours-and-Components/</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://datahonor.com/2017/05/27/Extracting-Lines-Contours-and-Components/"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
	clipboard.on('success', $(function(){
	  $(".fa-clipboard").click(function(){
		swal({   
		  title: "",   
		  text: '复制成功',   
		  html: false,
		  timer: 500,   
		  showConfirmButton: false
	    });
	  });
    }));  
</script>


      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Cpp/" rel="tag"># Cpp</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/05/25/OpenCV系列笔记二十二：滤波/" rel="next" title="OpenCV系列笔记二十二：滤波">
                <i class="fa fa-chevron-left"></i> OpenCV系列笔记二十二：滤波
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/05/28/Hough变换/" rel="prev" title="Hough变换">
                Hough变换 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        
<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">

    
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>









        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://avatars2.githubusercontent.com/u/17157965?v=3&u=1787d5d04d50967c7825062bfff705ee584ae2b2&s=400"
               alt="不秩稚童" />
          <p class="site-author-name" itemprop="name">不秩稚童</p>
           
              <p class="site-description motion-element" itemprop="description">十年饮冰，难凉热血。</p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">136</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">48</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/shenxiangzhuang" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/shen-xiang-zhuang" target="_blank" title="知乎">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  知乎
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.cnblogs.com/buzhizhitong" target="_blank" title="博客园">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  博客园
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#Overview"><span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Code"><span class="nav-text">Code</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Find-contours-by-Canny-operator"><span class="nav-text">Find contours by Canny operator</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Detecting-lines-in-images-with-the-Hough-transform"><span class="nav-text">Detecting lines in images with the Hough transform</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Extracting-connected-components-amp-amp-Computing-components’-shape-descriptors"><span class="nav-text">Extracting connected components && Computing components’ shape descriptors</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Quadrilateral-detection"><span class="nav-text">Quadrilateral detection</span></a></li></ol></li></ol></div>
            


          </div>
        </section>
      <!--/noindex-->
      

      


    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">不秩稚童</span>
</div>



        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i>本站访客数<span class="busuanzi-value" id="busuanzi_value_site_uv"></span>人次</span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i>本站总访问量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span>次</span>
  
  
</div>



        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  

    <script type="text/javascript">
      var disqus_shortname = 'http-datahonor-com';
      var disqus_identifier = '2017/05/27/Extracting-Lines-Contours-and-Components/';

      var disqus_title = "OpenCV系列笔记二十三：Extracting Lines, Contours, and Components";


      function run_disqus_script(disqus_script) {
        var dsq = document.createElement('script');
        dsq.type = 'text/javascript';
        dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      }

      run_disqus_script('count.js');

      
        var disqus_config = function () {
            this.page.url = disqus_url;
            this.page.identifier = disqus_identifier;
            this.page.title = disqus_title;
        };
        run_disqus_script('embed.js');
      

    </script>
  










  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


  
  <!-- 页面点击小红心 -->
  <script type="text/javascript" src="/js/src/love.js"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"skipTags":["script","noscript","style","textarea","pre","code"],"processEscapes":true},"TeX":{"equationNumbers":{"autoNumber":"AMS"}}});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

</body>
</html>
